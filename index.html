<!DOCTYPE html />
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<title>

AForm - 演示

</title>

</head>
<body>
    <div id="container">
        <div id="main">
        <table width="100%">
        <tr><td style="width:50%"><h3>输入json字符串：
        <select id="selExample" onchange="loadDemo()">
            <option value="json_schema_local">本地嵌套schema</option>
            <option value="json_interface">复杂json</option>
            <option value="json_mysql_tb">mysql表配置</option>
        	<option value="json_layout">行内布局</option>
        	<option value="json_types">数据类型</option>
        	<option value="json_rec">对象的嵌套</option>
        	<option value="json_rec_array">数组嵌套</option>
        	<option value="json_trip">出差申请</option>
        	<option value="json_plugin">插件</option>
        </select></h3>
        
        </td><td style="width:50%">    <h3>配置项：<label><input id="ckbEnableConfig" type="checkbox" checked onclick="enableConfig(this.checked)" />启用</label></h3>
</td></tr>
        <tr><td>    
    <textarea style="width:100%;height:150px" id="txtJson"></textarea>
</td><td>    <textarea style="width:100%;height:150px" id="txtConfig"></textarea>
</td></tr>
        </table>
<div style="margin:10px">
<input onclick="generate(txtJson.value,txtConfig.value)" type="button" style="height:30px" value="生成表单" />
</div>
<h3>表单生成结果</h3>
<form target="_blank" method="post" action="getData.php">
<div style="margin-top:10px;margin-bottom:10px;border:1px solid gray" id="form1">
<span style="font-size:13px;color:Gray">//表单将在这里生成</span>
</div>
&nbsp;
<input type="submit" value="提交表单" />
<input type="button" value="获取json数据" onclick="getString()" />
<br />&nbsp;
</form>
    <link href="aform.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="demo_data/json2.js"></script>
    <script src="aform.js" type="text/javascript"></script>
    <script src="aform.config.js" type="text/javascript"></script>
    <script src="aform.plugin.js" type="text/javascript"></script>
<script>
var ckbEnableConfig  = document.getElementById('ckbEnableConfig');
var txtConfig  = document.getElementById('txtConfig');
var txtJson = document.getElementById('txtJson');
g_enable_config = ckbEnableConfig.checked;

	function enableConfig(enable)
	{
		g_enable_config=enable;
		txtConfig.disabled = !g_enable_config;
		
		generate(txtJson.value,txtConfig.value);
	}
	
    function generate(input,config)
    {
    	if(!g_enable_config)config="{}";
    	
    	config = typeof config == "string" ? eval("(" + config + ")") : config;
    	input = typeof input == "string" ? eval("(" + input + ")") : input;
        jf = new AForm("form1", config);
        jf.render(input);
    }

    function getString()
    {
        alert(jf.getJsonString());

        if (console && console.dir) {
            console.dir(jf.getJson());
        }
    }
    
    function clearHeight()
    {
    	document.getElementById("txtHeight").value="";
    }
    
    function loadDemo()
    {
    	var exampleId = document.getElementById("selExample").value;
    	var jsDemo = document.createElement("script");
    	jsDemo.src = "demo_data/"+exampleId+".js?x="+Math.random();
    	jsDemo.type = "text/javascript";
    	jsDemo.id = "script_"+exampleId;
    	document.body.appendChild(jsDemo);
    }
    
    function cbGenForm(data,conf)
    {
    	conf = conf || {};
    	generate(data,conf);
    	
    	try
    	{
	     	//显示json字符串,防止ie8展示unicode格式的汉字
	   		eval("g_data = '"+JSON.stringify(data)+"';");
    	}
    	catch(ex)
    	{
    		g_data = JSON.stringify(data);
    	}
    	
    	try
    	{
	     	//显示json字符串,防止ie8展示unicode格式的汉字
    		eval("g_conf = '"+JSON.stringify(conf)+"';");
    	}
    	catch(ex)
    	{
    		g_conf = JSON.stringify(conf);
    	}
    	txtJson.value = g_data;
    	txtConfig.value = g_conf;
    }
    //初始化
    loadDemo();
   
</script>
        </div>
    </div>

<!-- 范例json -->

</body>
</html>
